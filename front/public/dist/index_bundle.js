(()=>{"use strict";var e={481:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var i={format:"image/png",quality:.92,width:void 0,height:void 0,Canvas:void 0,crossOrigin:void 0};const r=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t={}),new Promise((function(n){var r=(t=Object.assign({},i,t)).Canvas?new t.Canvas:window.document.createElement("canvas"),o=t.Image||window.Image,a=e.map((function(e){return new Promise((function(n,i){"Object"!==e.constructor.name&&(e={src:e});var r=new o;r.crossOrigin=t.crossOrigin,r.onerror=function(){return i(new Error("Couldn't load image"))},r.onload=function(){return n(Object.assign({},e,{img:r}))},r.src=e.src}))})),s=r.getContext("2d");n(Promise.all(a).then((function(e){var n=function(n){return t[n]||Math.max.apply(Math,e.map((function(e){return e.img[n]})))};return r.width=n("width"),r.height=n("height"),e.forEach((function(e){return s.globalAlpha=e.opacity?e.opacity:1,s.drawImage(e.img,e.x||0,e.y||0)})),t.Canvas&&"image/jpeg"===t.format?new Promise((function(e,n){r.toDataURL(t.format,{quality:t.quality,progressive:!1},(function(t,i){t?n(t):e(i)}))})):r.toDataURL(t.format,t.quality)})))}))}},607:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(481)),o=document.getElementById("main"),a=document.getElementById("camera-container"),s=document.getElementById("cam"),d=document.getElementById("start-btn"),c=document.getElementById("cursor"),l=document.getElementById("canvas"),m=l.getContext("2d"),u=document.getElementById("time"),g=document.getElementById("count"),p=document.getElementById("black"),y=document.getElementById("images"),f=document.getElementById("complete");let h=0;const v=1e3;let w,b=!1;p.classList.add("hidden"),navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then((e=>{s.srcObject=e,s.play()})),s.addEventListener("canplay",(()=>{b||(w=s.videoHeight/s.videoWidth*v,s.setAttribute("width",String(v)),s.setAttribute("height",String(w)),l.setAttribute("width",String(v)),l.setAttribute("height",String(w)),g.innerText=`${h}/4`,b=!0)}));const x=[];d.addEventListener("click",(()=>{o.classList.add("hidden"),a.classList.remove("hidden"),(async()=>{let e=1;for(let t=0;t<4;t++)for(let t=0;t<2;t++)await new Promise(((t,n)=>{setTimeout((async()=>{e<=0?(u.innerText="",p.classList.remove("hidden"),await new Promise(((e,t)=>{setTimeout((()=>{m.drawImage(s,0,0,v,w),l.toBlob((e=>{if(e){const t=new FormData;t.append("picture",e),fetch("/sendPicture",{method:"POST",headers:{Content_Type:"multipart/form-data"},body:t})}})),p.classList.add("hidden"),e("")}),2e3)})),h+=1,g.innerText=`${h}/4`,e=1):(u.innerText=String(e),e-=1),t(" ")}),1e3)}))})().then((()=>{u.innerText="âœ”",setTimeout((()=>{a.classList.add("hidden");for(let e=0;e<4;e++){const t=document.createElement("img");t.style.width="200px",t.src=`/picture/${e}.png`,t.classList.add("img"),y.append(t),t.addEventListener("click",(()=>{if(x.includes(e)){const n=x.indexOf(e);n>-1&&(x.splice(n,1),t.classList.remove("selected"))}else x.length<4&&(x.push(e),t.classList.add("selected"))}))}}),3e3)}))})),f.addEventListener("click",(()=>{4===x.length&&(0,r.default)([{src:"/frame/frame.png",x:0,y:0},{src:`/picture/${x[0]}.png`,x:10,y:50},{src:`/picture/${x[1]}.png`,x:10,y:100},{src:`/picture/${x[2]}.png`,x:10,y:150},{src:`/picture/${x[3]}.png`,x:10,y:200}]).then((e=>{console.log(e),fetch("createResult",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({b64:e})})}))})),window.addEventListener("mousemove",(e=>{c.style.left=`${e.clientX}px`,c.style.top=`${e.clientY}px`}))}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(607)})();